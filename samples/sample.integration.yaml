version: 1
kind: Integration

metadata:
  name: Facebook
  public_id: b780d792-bb57-4e29-a4a4-578d8db3bec9
  version: 1.0.0
  description: Lorem ipsum dolor sit amet
  category: accounting
  tags:
    - accounting
    - productivity
  avatar_id: 5ae00cd4-77bc-43ca-8122-1d6ea5c7bd5f
  homepage_url: teamcliff.io
  resource_nouns:
    - email
  authors:
    - name: James Brown
      email: james@brown.com

auths:
  oauth2s:
    - label: OAuth2
      scopes:
        - send_email
      should_refresh_automatically: true
      fields:
        - key: email # Used to refer to this field
          label: Email # User friendly label. Some markdown formatting allowed
          tip: Enter your email here # User friendly description.
          is_required: true # If field has to be filled.
          is_administrative: true # If field meant for admin.
          input_kind: email # Corresponds somewhat to input[type] and select.
          default_value: null
          dropdown: null # For dropdown input types.
      apis:
        authorisation_request:
          code: null
          language: null
          form:
            method: GET
            url: "https://api.teamcliff.io/auth"
            headers: null
            params:
              client_id: "{{env.CLIENT_ID}}"
              state: "{{env.STATE}}"
              redirect_uri: "{{env.REDIRECT_URI}}"
            body: null
        access_token_request:
          code: null
          language: null
          form:
            method: GET
            url: "https://api.teamcliff.io/auth"
            headers: null
            params: null
            body:
              code: "{{auths.oauth2s[0].apis.authorisation_request.response.body.code}}"
              client_id: "{{env.CLIENT_ID}}"
              client_secret: "{{env.CLIENT_SECRET}}"
              redirect_uri: "{{env.REDIRECT_URI}}"
              grant_type: "authorization_code"
        refresh_token_request:
          code: null
          language: null
          form:
            method: GET
            url: "https://api.teamcliff.io/auth"
            headers: null
            params:
              refresh_token: "{{auths.oauth2s[0].apis.authorisation_request.response.body.refresh_token}}"
              grant_type: "refresh_token"
            body: null
  api_keys:
    - label: API Key
      fields:
        - key: workspace
          label: Workspace
          tip: Select workspace
          is_required: true
          is_administrative: false
          input_kind: select
          default_value: null
          dropdown:
            kind: static # Options can be static or dynamic values
            allows_multiple: false # If multiple options can be selected
            allows_custom: true # If you can add you own custom entry
            options:
              - Google
              - Apple
      api:
        code: null
        language: null
        form:
          method: POST
          url: "https://api.teamcliff.io/auth"
          headers: null
          params: null
          body: null

operations:
  triggers:
    - key: new_email_subscriber
      label: New Email Subscriber
      tip: Triggers when there is a new email subscriber
      fields:
        - key: email
          label: Email
          tip: Enter your email here
          is_required: true
          is_write_op: false # If an operation that modifies or deletes resources.
          is_identification: true # If it is used to identify resource to operate on.
          resource_noun: email # A noun that best identifies what this trigger operates on.
          input_kind: select
          dropdown:
            kind: dynamic
            allows_multiple: false
            allows_custom: true
            options: "{{fields[0].email}}"
      apis:
        polls:
          - auth_kind: null
            code: null
            language: null
            form:
              method: GET
              url: "https://api.teamcliff.io/poll"
              headers: null
              params: null
              body: null
        rest_hooks:
          - auth_kind: null
            operations:
              subscribe:
                code: null
                language: null
                form:
                  method: POST
                  url: "https://api.teamcliff.io/hooks"
                  headers: null
                  params: null
                  body: null
              unsubscribe:
                code: null
                language: null
                form:
                  method: DELETE
                  url: "https://api.teamcliff.io/hooks"
                  headers: null
                  params: null
                  body: null
              list: # For checking recent items to provide sample data.
                code: null
                language: null
                form:
                  method: POST
                  url: "https://api.teamcliff.io/api"
                  headers: null
                  params: null
                  body: null

  actions:
    - action_kind: search
      key: add_email_subscriber
      label: Add Email Subscriber
      tip: Adds a new email subscriber
      fields:
      - key: email
        label: Email
        tip: Enter your email here
        is_required: true
        is_write_op: false # If an operation that modifies or deletes resources.
        is_identification: true # If it is used to identify resource to operate on.
        resource_noun: email # A noun that best identifies what this trigger operates on.
        input_kind: select
        dropdown:
          kind: dynamic
          allows_multiple: false
          allows_custom: true
          options: "{{fields[0].email}}"
      api:
        code: null
        language: null
        form:
          method: POST
          url: "https://api.teamcliff.io/auth"
          headers: null
          params: null
          body: null

